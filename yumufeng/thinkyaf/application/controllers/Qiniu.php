<?php
/**
 * Date: 2018\4\2 0002 11:28
 */

class QiniuController extends BaseController
{

    //类似thinkphp里的初始化功能
    public function init()
    {
        parent::init(); // TODO: Change the autogenerated stub
        //先检测用户是否登录
        $this->checkLogin();
    }

    /**
     * 获取token
     */
    public function GET_tokenAction()
    {
        $filekey = time() . Random::char(4);
        $expire = 1800; //过期时间 秒
        //获得bucket为 video的 里面文件为filekey的 token
        $token = \extend\Qiniu::getInstance('video')->getToken($filekey, $expire);
        $this->success('获取成功', $token);
    }

}