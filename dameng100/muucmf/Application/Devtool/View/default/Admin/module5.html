<extend name="Public/base"/>
<block name="body">
    <div class="main-title">
        <h2>{:L('_PACK_STEP_LAST_')}
            <small>{:L('_PACK_STEP_LAST_VICE_')}</small>
        </h2>
    </div>

    <div class="with-padding">
        <div class="alert alert-success">
            {:L('_PACK_CONGRATULATION_')}
        </div>
        <div class="clearfix">

            <div class="alert alert-info">
                {:L('_PACK_MODULE_NOW_')}{:L('_COMMA_')}<strong>{$module.alias}-{$module.name}</strong>
            </div>
        </div>
        <form id="form_main" action="{:U('module5')}" method="post">
            <div class="clearfix">

                <p class="lead">{:L('_PACK_GUIDE_JSON_CONTENT_')}</p>
                <p>{:L('_PACK_GUIDE_CONTENT_')}</p>
                <neq name="guide" value="">
                        <textarea name="guide" class="form-control" style="height: 200px">{:json_encode($guide)}</textarea>
                    <else/>
                    <div class="alert alert-success">{:L('_PACK_DETECTED_RELATED_TABLE_NONE_SKIP_')}</div>
                </neq>

            </div>
            <div class="clearfix">
                <p class="lead">{:L('_PACK_INSTALL_SCRIPT_')}</p>

                <p>{:L('_PACK_INSTALL_SCRIPT_CONTENT_')}</p>
                <neq name="install" value="">

                        <textarea name="install" class="form-control" style="height: 200px">{$install}</textarea>

                    <else/>
                    <div class="alert alert-success">{:L('_PACK_INSTALL_SCRIPT_NULL_')}</div>
                </neq>
                <script>
                    $(function () {
                        $('[data-role=check_table]').change(function () {
                            $.post(U('Admin/Devtool/backup_rows'),$('#form_main').serialize(),function(msg){
                                $('[name=sql_rows]').val(msg)
                            })
                        })
                    })
                </script>

            </div>
            <div class="clearfix">
                <p class="lead">{:L('_PACK_CLEAR_DATA_SCRIPT_')}</p>

                <p>{:L('_PACK_CLEAR_DATA_SCRIPT_CONTENT_')}</p>
                <neq name="cleanData" value="">

                    <textarea name="install" class="form-control" style="height: 200px">{$cleanData}</textarea>

                    <else/>
                    <div class="alert alert-success">{:L('_PACK_CLEAR_DATA_SCRIPT_NULL_')}</div>
                </neq>
                <script>
                    $(function () {
                        $('[data-role=check_table]').change(function () {
                            $.post(U('Admin/Devtool/backup_rows'),$('#form_main').serialize(),function(msg){
                                $('[name=sql_rows]').val(msg)
                            })
                        })
                    })
                </script>

            </div>
            <div class="with-padding">
                <label class="text-danger">{:L('_PACK_AUTO_REPLACE_')}</label>
            </div>
            <div class="with-padding">
                <a class="btn btn-lg btn-default" href="{:U('module4')}">
                    {:L('_STEP_PREV_')}
                </a>
                <neq name="havent_created" value="">
                    <php>$str='disabled="disabled"';</php>
                </neq>
                <a href="{:U('module')}" class="btn btn-lg btn-warning" >
                    {:L('_PACK_UP_RE_')}
                </a>
                <a target="_blank" href="{:U('replace')}" class="btn btn-lg btn-danger" style="width: 200px">
                    {:L('_PACK_REPLACE_INSTALL_FILE_')}
                </a>
                <a href="{:U('download')}" target="_blank" id="next_step" style="width: 300px" title="{$title}" {$str}
                       class="btn btn-lg btn-info">{:L('_PACK_DOWNLOAD_ZIP_')}</a>

                </input>


            </div>
        </form>


    </div>
</block>