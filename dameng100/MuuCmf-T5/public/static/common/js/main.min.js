"use strict";!function(s,a,t){var r=function(t){t.url&&(t.msg+="，页面即将跳转～"),1==t.code?toast.success(t.msg,"success"):toast.error(t.msg,"danger");"refresh"==t.url?setTimeout(function(){location.href=location.href},1e3):t.url&&setTimeout(function(){location.href=t.url},1e3)},c=function(t,e){""==t&&(t="确认执行该操作？");var o='<div class="modal fade confirm-modal" id="tip_Modal"><div class="modal-dialog modal-tip"><div class="modal-content"><div class="modal-body">'+('<div class="text-center"><i class="fa fa-exclamation-circle"></i><p class="title">系统提示</p><p class="desc">'+t+'</p><div class="text-center"><button class="btn btn-info confirm margin-right" type="button">确认</button><button type="button" class="btn" data-dismiss="modal">取消</button></div></div>')+"</div></div></div></div>";return 0==s("#tip_Modal").length&&s("body").append(o),s("#tip_Modal").modal("show"),s("#tip_Modal").off("click",".confirm"),s("#tip_Modal").on("click",".confirm",function(){"function"==typeof e&&e(),s('[data-dismiss="modal"]').click(),s("#tip_Modal").remove(),s(".modal-backdrop").remove()}),!1};s(document).ready(function(){s(document).on("click",".ajax-post",function(t){t.preventDefault();var e=s(this).attr("target-form");if(e){var o=s("."+e).serialize();if(""==o)return toast.error("请勾选操作对象!。","danger"),!1}var n=s(this).attr("href");if(s(this).attr("url")&&(n=s(this).attr("url")),s(this).attr("data-url")&&(n=s(this).attr("data-url")),s(this).attr("data-confirm")||s(this).hasClass("confirm")){var a=s(this).attr("data-confirm");a=a||"确认要执行该操作吗?"}if(a)return c(a,function(){i()}),!1;function i(){s.post(n,o,function(t,e,o){r(t)})}i()}),s(document).on("click",".ajax-get",function(t){t.preventDefault();var e=s(this).attr("target-form");if(e&&""==s("."+e).serialize())return toast.error("请勾选操作对象!。","danger"),!1;var o=s(this).attr("href");if(s(this).attr("url")&&(o=s(this).attr("url")),s(this).attr("data-url")&&(o=s(this).attr("data-url")),s(this).attr("data-confirm")||s(this).hasClass("confirm")){var n=s(this).attr("data-confirm");n=n||"确认要执行该操作吗?"}if(n)return c(n,function(){a()}),!1;function a(){s.get(o,function(t){r(t)})}a()}),s(document).on("submit","form.ajax-form",function(t){t.preventDefault();var e=s(this).attr("data-confirm"),n=s(this);if(""==n.serialize())return toast.hideLoading(),toast.error("请勾选操作对象!。","danger"),!1;if(e)return c(e,function(){o()}),!1;function o(){s("[type=submit]",n).addClass("disabled");var t=n.attr("action"),e=n.attr("method");t||(t=a.location.href),e||(e="get");var o=n.serialize();("post"==e?s.post:s.get)(t,o,function(t){r(t),s("[type=submit]",n).removeClass("disabled")})}return o(),!1})}),a.handleAjax=r,a.handle_ajax=r,a.modal_confirm=c}(jQuery,window);var follower={bind_follow:function(){$('[data-role="follow"]').unbind("click"),$('[data-role="follow"]').click(function(){var e=$(this),t=e.attr("data-follow-who");$.post(Url("Ucenter/Public/follow"),{uid:t},function(t){t.status?(e.attr("class",e.attr("data-before")),e.attr("data-role","unfollow"),e.html("已关注"),follower.bind_follow(),toast.success(t.info,"温馨提示")):toast.error(t.info,"温馨提示")},"json")}),$('[data-role="unfollow"]').unbind("click"),$('[data-role="unfollow"]').click(function(){var e=$(this),t=e.attr("data-follow-who");$.post(Url("Ucenter/Public/unfollow"),{uid:t},function(t){t.status?(e.attr("class",e.attr("data-after")),e.attr("data-role","follow"),e.html("关注"),follower.bind_follow(),toast.success(t.info,"温馨提示")):toast.error(t.info,"温馨提示")},"json")})}};function is_login(){return parseInt(MID)}function Url(t,e,o){var n="/";return""!=(t=t.split("/"))[0]&&"@"!=t[0]||(t[0]=APPNAME),t[1]||(t[1]="Index"),t[2]||(t[2]="index"),n=n+t[0]+"/"+t[1]+"/"+t[2],e&&(n=n+"/"+(e=e.join("/"))),o||(n+=".html"),n}function playsound(t){$("embed").remove(),$("body").append('<embed src="'+t+'" autostart="true" hidden="true" loop="false">')}function friendlyDate(t,e){var o=function(t){return t<10?"0"+t:t};if(!t)return"";var n=new Date(1e3*e),a=new Date(1e3*t),i=e-t,s=parseInt(n.getDate())-parseInt(a.getDate()),r=parseInt(n.getMonth()+1)-parseInt(a.getMonth()+1),c=parseInt(n.getFullYear())-parseInt(a.getFullYear());return i<60?i<10?"刚刚":parseInt(10*Math.floor(i/10))+"秒前":i<3600?parseInt(Math.floor(i/60))+"分钟前":0===c&&0===r&&0===s?"今天"+o(a.getHours())+":"+o(a.getMinutes()):0===c?o(a.getMonth()+1)+"月"+o(a.getDate())+"日 "+o(a.getHours())+":"+o(a.getMinutes()):a.getFullYear()+"-"+o(a.getMonth()+1)+"-"+o(a.getDate())+" "+o(a.getHours())+":"+o(a.getMinutes())}follower.bind_follow(),function($){var obj,checkCan=new Array,patterns=new Object;patterns.Ip=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])(\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])){3}$/,patterns.Email=/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/,patterns.Date=/^\d{4}-(0?[1-9]|1[0-2])-(0?[1-9]|[1-2]\d|3[0-1])$/,patterns.Time=new RegExp("^([0-1]\\d|2[0-3]):[0-5]\\d:[0-5]\\d$"),patterns.Num=/^[0-9]*$/,patterns.FloatNum=/^\d+(\.\d+)?$/,patterns.DateAndTime=/^(?:19|20)[0-9][0-9]-(?:(?:0[1-9])|(?:1[0-2]))-(?:(?:[0-2][1-9])|(?:[1-3][0-1])) (?:(?:[0-2][0-3])|(?:[0-1][0-9])):[0-5][0-9](:[0-5][0-9])?$/,patterns.Phone=/^(1[3|4|5|8])[0-9]{9}$/,patterns.Chinese=/^[\u4e00-\u9fa5]{2,8}$/,patterns.QQ=new RegExp("^[1-9]\\d{4,10}$"),patterns.Telephone=/^((0\d{2,3})-)(\d{7,8})(-(\d{3,}))?$/,patterns.isIDCard1=/^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$/,patterns.isIDCard2=/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/;var bind_form_check=function bind_form_check(){$(".form_check").after('<div class=" show_info" ></div>'),$(".form_check").click(function(){}),$(".form_check").focus(function(){}),$(".form_check").blur(function(){obj=$(this);var type=obj.attr("check-type"),checkLength=checkInputLength();if(0!=checkLength.status){var check=eval("check"+type+"()");obj.attr("check-url")||showInfo(check.info,check.status)}else showInfo(checkLength.info,checkLength.status)}),$(".form_check").change(function(){$(this).blur()}),$(":submit").click(function(t){var e=!0;for(var o in checkCan)e&=checkCan[o];if(!e)return toast.error("请填写完整且正确的信息后再提交！"),t.preventDefault(),!1})},checkEmpty=function(){return 0!=obj.val().length},checkInputLength=function(){var t=obj.val().replace(/\s+/g,"");if(0==t.length)return{status:0,info:"不能为空"};if(void 0!==obj.attr("check-length")){var e=new Array;if((e=obj.attr("check-length").split(","))[1]){if("*"==e[1]){if(t.length<e[0])return{status:0,info:"字数不能少于"+e[0]+"个"}}else if(e[1]<t.length||t.length<e[0]){return{status:0,info:"要求字数为"+e[0]+"-"+e[1]+"个"}}}else if(e[0]<t.length)return{status:0,info:"字数不能少于"+e[0]+"个"}}return{status:1,info:""}},checkText=function(){return{status:1,info:""}},checkChinese=function(){var t=obj.val();if(patterns.Chinese.test(t))var e={status:1,info:""};else e={status:0,info:"请输入2-8个汉字的姓名"};return e},checkQQ=function(){var t=obj.val();if(patterns.QQ.test(t))var e={status:1,info:""};else e={status:0,info:"请输入正确qq号！"};return e},checkEmail=function(){var t=obj.val();if(patterns.Email.test(t))var e={status:1,info:""};else e={status:0,info:"请输入正确Email地址！"};return e},checkIDCard=function(){var t=obj.val();if(patterns.isIDCard1.test(t)||patterns.isIDCard2.test(t))var e={status:1,info:""};else e={status:0,info:"请输入正确身份证号！"};return e},checkDate=function(){var t=obj.val();if(patterns.Date.test(t))var e={status:1,info:""};else e={status:0,info:"请填写正确的格式！"};return e},checkDateAndTime=function(){var t=obj.val();if(patterns.DateAndTime.test(t))var e={status:1,info:""};else e={status:0,info:"请填写正确的格式！"};return e},checkNum=function(){var t=obj.val();if(patterns.Num.test(parseInt(t))){if(void 0!==obj.attr("check-value")){var e=new Array;if(e=obj.attr("check-value").split(","),t=parseInt(obj.val()),e[1]){if("*"==e[1])if(t<parseInt(e[0]))return o={status:0,info:"数字至少为"+parseInt(e[0])};if(parseInt(e[1])<t||t<parseInt(e[0]))return o={status:0,info:"数字范围在"+e+"内"}}else{if(parseInt(e[0])<t)return o={status:0,info:"数字范围在"+e+"内"}}}var o={status:1,info:""}}else o={status:0,info:"请填写数字！"};return o},checkIntNum=function(){var t=obj.val();if(parseInt(t)!=t)return o={status:0,info:"请填写整数数字！"};if(patterns.Num.test(parseInt(t))){if(void 0!==obj.attr("check-value")){var e=new Array;if(e=obj.attr("check-value").split(","),t=parseInt(obj.val()),e[1]){if("*"==e[1])if(t<parseInt(e[0]))return o={status:0,info:"数字至少为"+parseInt(e[0])};if(parseInt(e[1])<t||t<parseInt(e[0]))return o={status:0,info:"数字范围在"+e+"内"}}else{if(parseInt(e[0])<t)return o={status:0,info:"数字范围在"+e+"内"}}}var o={status:1,info:""}}else o={status:0,info:"请填写整数数字！"};return o},checkFloatNum=function(){var t=obj.val();if(parseFloat(t)!=t)return o={status:0,info:"请填写浮点型数字！"};if(patterns.FloatNum.test(parseFloat(t))){if(void 0!==obj.attr("check-value")){var e=new Array;if(e=obj.attr("check-value").split(","),t=parseFloat(obj.val()),e[1]){if("*"==e[1])if(t<parseFloat(e[0]))return o={status:0,info:"数字至少为"+parseFloat(e[0])};if(parseFloat(e[1])<t||t<parseFloat(e[0]))return o={status:0,info:"数字范围在"+e+"内"}}else{if(parseFloat(e[0])<t)return o={status:0,info:"数字范围在"+e+"内"}}}var o={status:1,info:""}}else o={status:0,info:"请填写整数数字！"};return o},checkPhoneOrTelephone=function(){var t=obj.val();if(patterns.Phone.test(parseInt(t))||patterns.Telephone.test(t))var e={status:1,info:""};else e={status:0,info:"请填写手机号码或固定电话！"};return e},checkPhone=function(){var t=obj.val();if(patterns.Phone.test(parseInt(t)))var e={status:1,info:""};else e={status:0,info:"请填写手机号码！"};return e},checkTelephone=function(){var t=obj.val();if(patterns.Telephone.test(t))var e={status:1,info:""};else e={status:0,info:"请填写固定电话号码！"};return e},checkSelect=function(){var t=obj.val();if(0==t&&1==obj.attr("can-empty"))return check_form.remove(),void(checkCan[obj.attr("name")]=1);if(0!=t&&""!=t&&void 0!==t)var e={status:1,info:""};else e={status:0,info:"请选择！"};return e},checkRegExps=function(){var t=obj.attr("reg-exp");if(void 0!==t){var e=obj.val();if((t=new RegExp(t)).test(e))var o={status:1,info:""};else o={status:0,info:obj.attr("error-info")||"请按正确格式填写！"};return o}checkCan[obj.attr("name")]=1},checkUsername=function(){var t=obj.val(),e=obj.attr("check-url");$.post(e,{account:t,type:"username"},function(t){ajaxRerurn(t)},"json")},checkUserEmail=function(){var t=obj.val(),e=obj.attr("check-url");$.post(e,{account:t,type:"email"},function(t){ajaxRerurn(t)},"json")},checkUserMobile=function(){var t=obj.val(),e=obj.attr("check-url");$.post(e,{account:t,type:"mobile"},function(t){ajaxRerurn(t)},"json")},checkNickname=function(){var t=obj.val(),e=obj.attr("check-url");$.post(e,{nickname:t},function(t){ajaxRerurn(t)},"json")},ajaxRerurn=function(t){t.code?(checkCan[obj.attr("name")]=1,check_form.success(t.msg)):(checkCan[obj.attr("name")]=0,check_form.error(t.msg))},showInfo=function(t,e){check_form.remove(),1==e||1==e?(check_form.success(t),check_form.remove()):check_form.error(t)},removeInfo=function(){obj.parent().find(".show_info").html("")},check_form={remove:function(){removeInfo()},error:function(t){var e;e='<div class="send red"><i class="icon-remove-sign"></i> '+t+"</div>",obj.parent().find(".show_info").html(e)},success:function(t){var e;e='<div class="send green"><i class="icon-check-circle"></i> '+t+"</div>",obj.parent().find(".show_info").html(e)}};$(document).ready(function(t){bind_form_check()})}(jQuery),$(function(){$(window).on("scroll",function(){0<$(document).scrollTop()?$("#go-top").css("display","block"):$("#go-top").hide()}),$("#tool .go-top").on("click",function(){$("html,body").animate({scrollTop:0},500)}),$("#go-top .uc-2vm").hover(function(){$("#go-top .uc-2vm-pop").removeClass("dn")},function(){$("#go-top .uc-2vm-pop").addClass("dn")})}),$(function(){$("[event-node=logout]").click(function(){var t=$(this).data("url");$.get(t,function(t){toast.success(t.msg+"。","温馨提示"),setTimeout(function(){location.href=t.url},1500)},"json")})}),function(a,t,e){if(void 0===a)throw new Error("MUU requires jQuery");a.muu||(a.muu=function(t){a.isPlainObject(t)&&a.extend(a.muu,t)});var o=function(){var t=Config.GET_INFORMATION_API;a.get(t,{},function(t){0!=t.messages.length&&(playsound("/static/common/lib/toastr/tip.mp3"),toast.info("有新消息~")),a('[data-role="now-message-num"]').text(t.message_count),0==t.message_count?a('[data-role="now-message-num"]').hide():a('[data-role="now-message-num"]').show()},"json")},n="",i=1;a.muu({check_message:o,bind_message_checker:function(){0<MID&&Config.GET_INFORMATION&&setInterval(function(){o()},Config.GET_INFORMATION_INTERNAL)},init_message:function(){a('[data-role="open-slider-box"]').unbind(),a('[data-role="open-slider-box"]').click(function(){toast.showLoading();var t=a(this).attr("data-url");a.post(t,{},function(t){a("#message-type-box").find(".message-type-list").html(t),a('[data-role="open-message-list"]').first().click()}),toast.hideLoading()})},list_message:function(){a('[data-role="open-message-list"]').unbind(),a('[data-role="open-message-list"]').click(function(){var t=a(this).attr("data-url");n=a(this).attr("data-type"),a.post(t,{tab:n},function(t){a(".message-info-list").html(t)})})},list_message_load_more:function(){a(".message-info-list").attr("data-page",1),a(".loadmore-type-messages").unbind(),a(".loadmore-type-messages").click(function(){var e=a(this),t=e.attr("data-url");e.html("加载中"),i+=1,a.post(t,{tab:n,page:i,r:10},function(t){t.length?(a(".message-info-list").append(t),e.html("加载更多")):e.html("已经没有喽")})})},send_imessage:function(){a("#iMessageAjaxPost").unbind("click"),a("#iMessageAjaxPost").click(function(){var e=a(this);e.text("发送中...");var t=e.attr("data-url"),o=a("input[name$='iMessageUid']").val(),n=a("#iMessageTxt").val();a.post(t,{iMessageUid:o,iMessageTxt:n},function(t){t.status?(toast.success(t.info,"发送成功"),e.text("发送完成")):(toast.error(t.info,"发送失败"),e.text("发送"))},"json")})}})}(jQuery,window),$(document).ready(function(t){$.muu.bind_message_checker(),$.muu.send_imessage()});var toast={success:function(t){toast.show(t,{placement:"center",type:"success",close:!0})},error:function(t){toast.show(t,{placement:"center",type:"danger",close:!0})},info:function(t){toast.show(t,{placement:"center",type:"info",close:!0})},warning:function(t,e){toast.show(t,{placement:"center",type:"warning",close:!0})},show:function(t,e){$.zui?$.zui.messager.show(t,e):$.messager.show(t,e)},showLoading:function(){$("body").append('<div class="big_loading"><img src="/static/common/images/big_loading.gif"/></div>')},hideLoading:function(){$("div").remove(".big_loading")}};jQuery,function(t,e){var o=null;function n(){this.opction=null,this.patchOpction=null,this.swf_path="",this.uploader=null,o=t.WebUploader}n.prototype.init=function(t){if(!o)throw new Error("请引入对应的webuploader.js文件，具体下载地址在webuploader官网");if(!o.Uploader.support())throw new Error("Web Uploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器");if(this.opction=t,this.swf_path=this.opction.swf_path,this.patchOpction=this.opction.patchOpction,!this.swf_path)throw new Error("webuploader 组件的swf路径为空，请设置路径");return this.patchOpction&&o.Uploader.register({"add-file":"addFile","before-send-file":"beforeSendFile","before-send":"beforeSend","after-send-file":"afterSendFile"},{addFile:this.patchOpction.addFile||function(t){console.log(t)},beforeSendFile:this.patchOpction.beforeSendFile||function(t){console.log(t)},beforeSend:this.patchOpction.beforeSend||function(t){console.log(t)},afterSendFile:this.patchOpction.afterSendFile||function(t){console.log(t)}}),this.uploader=o.create({dnd:this.opction.dnd,disableGlobalDnd:this.opction.disableGlobalDnd||!1,paste:document.body,pick:{id:"#"+this.opction.selectFileId,innerHTML:this.opction.selectFileLabel||"点击选择图片",multiple:this.opction.selectFileMultiple||!1},accept:this.opction.accept||{title:"Images",extensions:"gif,jpg,jpeg,bmp,png",mimeTypes:"image/*"},thumb:this.opction.thumb||{width:110,height:110,quality:70,allowMagnify:!0,crop:!0,type:"image/jpeg"},compress:this.opction.compress||{width:1600,height:1600,quality:90,allowMagnify:!1,crop:!1,preserveHeaders:!0,noCompressIfLarger:!1,compressSize:0},auto:this.opction.auto||!1,runtimeOrder:this.opction.runtimeOrder||"html5,flash",prepareNextFile:this.opction.prepareNextFile||!1,chunked:this.opction.chunked||!1,chunkSize:this.opction.chunkSize||5242880,chunkRetry:this.opction.chunkRetry||2,threads:this.opction["threads "]||3,fileVal:this.opction.fileVal||"file",method:this.opction.method||"POST",formData:this.opction["formData "]||{},sendAsBinary:this.opction.sendAsBinary||!1,fileNumLimit:this.opction.fileNumLimit||1,fileSizeLimit:this.opction.fileSizeLimit||5242880,fileSingleSizeLimit:this.opction.fileSingleSizeLimit||1048576,duplicate:this.opction.duplicate,swf:this.swf_path,server:this.opction.server}),this.uploader.on("beforeFileQueued",this.opction.beforeFileQueued||function(t){console.log(t)}),this.uploader.on("fileQueued",this.opction.fileQueued||function(t){console.log("fileQueued",t)}),this.uploader.on("filesQueued",this.opction.filesQueued||function(t){console.log("filesQueued",t)}),this.uploader.on("fileDequeued",this.opction.fileDequeued||function(t){console.log("fileDequeued",t)}),this.uploader.on("reset",this.opction.reset||function(){}),this.uploader.on("startUpload",this.opction.startUpload||function(){}),this.uploader.on("stopUpload",this.opction.stopUpload||function(){}),this.uploader.on("uploadFinished",this.opction.uploadFinished||function(){}),this.uploader.on("uploadStart",this.opction.uploadStart||function(t){console.log("uploadStart",t)}),this.uploader.on("uploadBeforeSend",this.opction.uploadBeforeSend||function(t,e,o){console.log("uploadBeforeSend",t,e,o)}),this.uploader.on("uploadAccept",this.opction.uploadAccept||function(t,e){console.log("uploadAccept",t,e)}),this.uploader.on("uploadProgress",this.opction.uploadProgress||function(t,e){console.log("uploadProgress",t,e)}),this.uploader.on("uploadError",this.opction.uploadError||function(t,e){console.log("uploadError",t,e,"上传失败")}),this.uploader.on("uploadSuccess",this.opction.uploadSuccess||function(t,e){console.log("uploadSuccess",t,e,"上传成功")}),this.uploader.on("uploadComplete",this.opction.uploadComplete||function(t){console.log("uploadComplete",t,"上传结束")}),this.uploader.on("error",this.opction.error||function(t){console.log("error",t)}),this.uploader},t.muuUploader=new n}(window,$);